.\" Man page generated from reStructeredText.
.
.TH VMOD_GEOIP 3 "2013-05-13" "0.4" ""
.SH NAME
vmod_geoip \- Varnish Geoip Module
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
import geoip;
.SH DESCRipTION
.sp
libvmod\-geoip extends Varnish, to use Geoip functionality from inside VCL.
.SH FUNCTIONS
.SS load_geoip_db
.INDENT 0.0
.TP
.B Prototype
.sp
.nf
.ft C
load_geoip_db(STRING S)
.ft P
.fi
.TP
.B Return value
.
VOID
.TP
.B Description
.
Loads the Geoip database file.
.TP
.B Example
.sp
.nf
.ft C
vcl_init {
    geoip.load_geoip_db("/var/lib/Geoip/Geoip.dat");
    return (ok);
}
.ft P
.fi
.UNINDENT
.SS get_country_code
.INDENT 0.0
.TP
.B Prototype
.sp
.nf
.ft C
get_country_code(STRING S)
.ft P
.fi
.TP
.B Return value
.
STRING country code, NULL as STRING if ip address was not found in the Geoip database.
.TP
.B Description
.
Returns the country code which belongs to the passed ip address.
.TP
.B Example
.sp
.nf
.ft C
vcl_recv {
    set req.http.X\-Forwarded\-For = client.ip;
    set req.http.X\-Country\-Code = geoip.get_country_code(req.http.X\-Forwarded\-For);
}
.ft P
.fi
.UNINDENT
.SS get_country_name
.INDENT 0.0
.TP
.B Prototype
.sp
.nf
.ft C
get_country_name(STRING S)
.ft P
.fi
.TP
.B Return value
.
STRING country name, NULL as STRING if ip address was not found in the Geoip database.
.TP
.B Description
.
Returns the country name which belongs to the passed ip address.
.TP
.B Example
.sp
.nf
.ft C
vcl_recv {
    set req.http.X\-Forwarded\-For = client.ip;
    set req.http.X\-Country\-Name = geoip.get_country_name(req.http.X\-Forwarded\-For);
}
.ft P
.fi
.UNINDENT
.SH INSTALLATION
.sp
The source tree is based on autotools to configure the building, and
does also have the necessary bits in place to do functional unit tests
using the varnishtest tool.
.sp
Usage:
.sp
.nf
.ft C
\&./configure VARNISHSRC=DIR [VMODDIR=DIR]
.ft P
.fi
.sp
\fIVARNISHSRC\fP is the directory of the Varnish source tree for which to
compile your vmod. Both the \fIVARNISHSRC\fP and \fIVARNISHSRC/include\fP
will be added to the include search paths for your module.
.sp
Optionally you can also set the vmod install directory by adding
\fIVMODDIR=DIR\fP (defaults to the pkg\-config discovered directory from your
Varnish installation).
.sp
Make targets:
.INDENT 0.0
.IP \(bu 2
.
make \- builds the vmod
.IP \(bu 2
.
make install \- installs your vmod in \fIVMODDIR\fP
.IP \(bu 2
.
make check \- runs the unit tests in \fCsrc/tests/*.vtc\fP
.UNINDENT
.SH HISTORY
.sp
This manual page was released as part of the libvmod\-geoip package.
.SH COPYRIGHT
.sp
This document is licensed under the same license as the
libvmod\-geoip project. See LICENSE for details.
.INDENT 0.0
.IP \(bu 2
.
Copyright (c) 2011 Varnish Software
.IP \(bu 2
.
Copyright (c) 2013 Martin Probst
.UNINDENT
.SH AUTHOR
Martin Probst <github@megamaddin.org>
.\" Generated by docutils manpage writer.
.\" 
.
